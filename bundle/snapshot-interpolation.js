var Snap;Snap=(()=>{"use strict";var t={571:(t,e,r)=>{var n=r(607),i=r(607);e.default={SnapshotInterpolation:n.SnapshotInterpolation,Vault:i.Vault}},607:function(t,e,r){
/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/geckosio/snapshot-interpolation
 * @license      {@link https://github.com/geckosio/snapshot-interpolation/blob/master/LICENSE|GNU GPLv3}
 */
var n=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return i(e,t),e};Object.defineProperty(e,"__esModule",{value:!0}),e.Types=e.Vault=e.SnapshotInterpolation=void 0;var a=r(160);Object.defineProperty(e,"SnapshotInterpolation",{enumerable:!0,get:function(){return a.SnapshotInterpolation}});var u=r(782);Object.defineProperty(e,"Vault",{enumerable:!0,get:function(){return u.Vault}}),e.Types=o(r(699))},975:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.radianLerp=e.degreeLerp=e.lerp=void 0;var r=3.14159265359,n=6.28318530718;e.lerp=function(t,e,r){return t+(e-t)*r};e.degreeLerp=function(t,r,n){var i,o=r-t;return o<-180?(r+=360,(i=e.lerp(t,r,n))>=360&&(i-=360)):o>180?(r-=360,(i=e.lerp(t,r,n))<0&&(i+=360)):i=e.lerp(t,r,n),i};e.radianLerp=function(t,i,o){var a,u=i-t;return u<-r?(i+=n,(a=e.lerp(t,i,o))>=n&&(a-=n)):u>r?(i-=n,(a=e.lerp(t,i,o))<0&&(a+=n)):a=e.lerp(t,i,o),a}},123:(t,e)=>{
/**
 * @author        three.js authors
 * @copyright     Copyright Â© 2010-2021 three.js authors
 * @license       {@link https://github.com/mrdoob/three.js/blob/dev/LICENSE|MIT}
 * @description   Copied and modified from: https://github.com/mrdoob/three.js/blob/464efc85ecfda5c03d786d15d8f8eff20d70f256/src/math/Quaternion.js
 */
Object.defineProperty(e,"__esModule",{value:!0}),e.quatSlerp=void 0;e.quatSlerp=function(t,e,r){if(0===r)return t;if(1===r)return e;var n=t.x,i=t.y,o=t.z,a=t.w,u=e.x,f=e.y,s=e.z,p=e.w;if(a!==p||n!==u||i!==f||o!==s){var l=1-r,c=n*u+i*f+o*s+a*p,d=c>=0?1:-1,h=1-c*c;if(h>.001){var v=Math.sqrt(h),y=Math.atan2(v,c*d);l=Math.sin(l*y)/v,r=Math.sin(r*y)/v}var _=r*d;if(n=n*l+u*_,i=i*l+f*_,o=o*l+s*_,a=a*l+p*_,l===1-r){var b=1/Math.sqrt(n*n+i*i+o*o+a*a);n*=b,i*=b,o*=b,a*=b}}return{x:n,y:i,z:o,w:a}}},160:function(t,e,r){var n=this&&this.__assign||function(){return(n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.SnapshotInterpolation=void 0;var i=r(782),o=r(975),a=r(123),u=function(){function t(t){this.vault=new i.Vault,this._interpolationBuffer=100,this._timeOffset=-1,this.serverTime=0,t&&(this._interpolationBuffer=1e3/t*3)}return Object.defineProperty(t.prototype,"interpolationBuffer",{get:function(){var t=this;return{get:function(){return t._interpolationBuffer},set:function(e){t._interpolationBuffer=e}}},enumerable:!1,configurable:!0}),t.Now=function(){return Date.now()},Object.defineProperty(t.prototype,"timeOffset",{get:function(){return this._timeOffset},enumerable:!1,configurable:!0}),t.NewId=function(){return Math.random().toString(36).substr(2,6)},Object.defineProperty(t.prototype,"snapshot",{get:function(){var e=this;return{create:function(e){return t.CreateSnapshot(e)},add:function(t){return e.addSnapshot(t)}}},enumerable:!1,configurable:!0}),t.CreateSnapshot=function(e){var r=function(t){if(!Array.isArray(t))throw new Error("You have to pass an Array to createSnapshot()");if(t.filter((function(t){return"string"!=typeof t.id&&"number"!=typeof t.id})).length>0)throw new Error("Each Entity needs to have a id")};return Array.isArray(e)?r(e):Object.keys(e).forEach((function(t){r(e[t])})),{id:t.NewId(),time:t.Now(),state:e}},t.prototype.addSnapshot=function(e){-1===this._timeOffset&&(this._timeOffset=t.Now()-e.time),this.vault.add(e)},t.prototype.interpolate=function(t,e,r,n,i){return void 0===i&&(i=""),this._interpolate(t,e,r,n,i)},t.prototype._interpolate=function(t,e,r,i,u){var f=[t,e].sort((function(t,e){return e.time-t.time})),s=i.trim().replace(/\W+/," ").split(" "),p=f[0],l=f[1],c=p.time,d=l.time,h=r<=1?r:(r-d)/(c-d);this.serverTime=o.lerp(d,c,h);if(!Array.isArray(p.state)&&""===u)throw new Error('You forgot to add the "deep" parameter.');if(Array.isArray(p.state)&&""!==u)throw new Error('No "deep" needed it state is an array.');var v=Array.isArray(p.state)?p.state:p.state[u],y=Array.isArray(l.state)?l.state:l.state[u],_=JSON.parse(JSON.stringify(n(n({},p),{state:v})));return v.forEach((function(t,e){var r=t.id,n=y.find((function(t){return t.id===r}));n&&s.forEach((function(r){var i=r.match(/\w\(([\w]+)\)/),u=i?null==i?void 0:i[1]:"linear";i&&(r=null==i?void 0:i[0].replace(/\([\S]+$/gm,""));var f=null==t?void 0:t[r],s=function(t,e,r,n){if(void 0!==e&&void 0!==r){if("string"==typeof e||"string"==typeof r)throw new Error("Can't interpolate string!");if("number"==typeof e&&"number"==typeof r){if("linear"===t)return o.lerp(e,r,n);if("deg"===t)return o.degreeLerp(e,r,n);if("rad"===t)return o.radianLerp(e,r,n)}if("object"==typeof e&&"object"==typeof r&&"quat"===t)return a.quatSlerp(e,r,n);throw new Error('No lerp method "'+t+'" found!')}}(u,null==n?void 0:n[r],f,h);Array.isArray(_.state)&&(_.state[e][r]=s)}))})),{state:_.state,percentage:h,newer:p.id,older:l.id}},t.prototype.calcInterpolation=function(e,r){void 0===r&&(r="");var n=t.Now()-this._timeOffset-this._interpolationBuffer,i=this.vault.get(n);if(i){var o=i.older,a=i.newer;if(o&&a)return this._interpolate(a,o,n,e,r)}},t}();e.SnapshotInterpolation=u},699:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},782:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Vault=void 0;var r=function(){function t(){this._vault=[],this._vaultSize=120}return t.prototype.getById=function(t){var e;return null===(e=this._vault.filter((function(e){return e.id===t})))||void 0===e?void 0:e[0]},t.prototype.get=function(t,e){var r,n=this._vault.sort((function(t,e){return e.time-t.time}));if(void 0===t)return n[0];for(var i=0;i<n.length;i++){if(n[i].time<=t){var o={older:n[i],newer:n[i-1]};if(e){var a=Math.abs(t-o.older.time),u=Math.abs(t-(null===(r=o.newer)||void 0===r?void 0:r.time));return isNaN(u)||u<=a?o.older:o.newer}return o}}},t.prototype.add=function(t){this._vault.length>this._vaultSize-1&&this._vault.sort((function(t,e){return t.time-e.time})).shift(),this._vault.push(t)},Object.defineProperty(t.prototype,"size",{get:function(){return this._vault.length},enumerable:!1,configurable:!0}),t.prototype.setMaxSize=function(t){this._vaultSize=t},t.prototype.getMaxSize=function(){return this._vaultSize},t}();e.Vault=r}},e={};return function r(n){if(e[n])return e[n].exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}(571)})().default;